<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # SECURITY: Block access to sensitive files and directories
    RewriteCond %{REQUEST_URI} "(^\.env$|^\.env\.|\.git/|/storage/|/vendor/|/bootstrap/cache/|/database/|/node_modules/|composer\.(json|lock)|package\.(json|lock)|artisan|phpunit\.xml|webpack\.mix\.js)" [NC]
    RewriteRule .* - [F,L]
    
    # Redirect Trailing Slashes If Not A Folder
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} (.+)/$
    RewriteRule ^ %1 [L,R=301]
    
    # Don't redirect if already in public folder
    RewriteCond %{REQUEST_URI} !^/public/
    
    # Don't redirect if file exists in root
    RewriteCond %{REQUEST_FILENAME} !-f
    
    # Don't redirect if directory exists in root
    RewriteCond %{REQUEST_FILENAME} !-d
    
    # Redirect everything else to public folder
    RewriteRule ^(.*)$ public/$1 [L]
</IfModule>
